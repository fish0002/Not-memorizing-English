<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="user-card">
    <view class="user-info">
      <button wx:if="{{!userInfo.avatarUrl}}" 
              class="avatar-wrapper" 
              open-type="chooseAvatar" 
              bind:chooseavatar="onChooseAvatar">
        <image class="avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      </button>
      <image wx:else class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
      
      <view class="info-right">
        <input wx:if="{{!userInfo.nickName}}" 
               type="nickname" 
               class="nickname-input" 
               placeholder="ç‚¹å‡»è®¾ç½®æ˜µç§°"
               bindchange="onGetNickname" />
        <text wx:else class="nickname">{{userInfo.nickName}}</text>
        <text class="level-tag">Lv.{{learningStats.level}}</text>
      </view>
    </view>

    <view class="exp-bar" wx:if="{{isLoggedIn}}">
      <progress class="level-progress" 
                percent="{{learningStats.experience/learningStats.nextLevel*100}}" 
                stroke-width="3" 
                activeColor="#4CAF50"
                backgroundColor="#E8F5E9"/>
      <text class="exp-text">{{learningStats.experience}}/{{learningStats.nextLevel}}</text>
    </view>
  </view>

  <!-- å­¦ä¹ æ•°æ®å¡ç‰‡ -->
  <view class="stats-section" wx:if="{{isLoggedIn}}">
    <view class="stats-grid">
      <view class="stat-item">
        <view class="stat-icon">ğŸ“š</view>
        <text class="stat-num">{{learningStats.totalWords}}</text>
        <text class="stat-label">è¯æ±‡é‡</text>
      </view>
      <view class="stat-item">
        <view class="stat-icon">ğŸ”¥</view>
        <text class="stat-num">{{learningStats.streak}}</text>
        <text class="stat-label">è¿ç»­æ‰“å¡</text>
      </view>
      <view class="stat-item">
        <view class="stat-icon">ğŸ“…</view>
        <text class="stat-num">{{learningStats.totalDays}}</text>
        <text class="stat-label">å­¦ä¹ å¤©æ•°</text>
      </view>
      <view class="stat-item">
        <view class="stat-icon">â±ï¸</view>
        <text class="stat-num">{{learningStats.todayMinutes}}</text>
        <text class="stat-label">ä»Šæ—¥å­¦ä¹ </text>
      </view>
    </view>
  </view>

  <!-- è®¾ç½®èœå• -->
  <view class="menu-card">
    <view class="menu-group">
      <view class="menu-title">å­¦ä¹ è®¾ç½®</view>
      <view class="menu-item" bindtap="handleSetDailyGoal">
        <view class="menu-left">
          <view class="menu-icon">ğŸ¯</view>
          <text class="menu-text">æ¯æ—¥ç›®æ ‡</text>
        </view>
        <view class="menu-right">
          <text class="menu-value">{{settings.dailyGoal}}ä¸ªå•è¯</text>
          <text class="arrow">></text>
        </view>
      </view>

      <view class="menu-item" bindtap="handleSetReminder">
        <view class="menu-left">
          <view class="menu-icon">â°</view>
          <text class="menu-text">å­¦ä¹ æé†’</text>
        </view>
        <view class="menu-right">
          <text class="menu-value">{{settings.reminderTime}}</text>
          <text class="arrow">></text>
        </view>
      </view>

      <view class="menu-item" bindtap="handleTogglePronunciation">
        <view class="menu-left">
          <view class="menu-icon">ğŸ”Š</view>
          <text class="menu-text">å‘éŸ³è®¾ç½®</text>
        </view>
        <view class="menu-right">
          <text class="menu-value">{{settings.pronunciation === 'us' ? 'ç¾å¼å‘éŸ³' : 'è‹±å¼å‘éŸ³'}}</text>
          <text class="arrow">></text>
        </view>
      </view>

      <view class="menu-item">
        <view class="menu-left">
          <view class="menu-icon">ğŸµ</view>
          <text class="menu-text">è‡ªåŠ¨æ’­æ”¾</text>
        </view>
        <switch class="menu-switch" color="#4CAF50" checked="{{settings.autoPlay}}" bindchange="handleToggleAutoPlay"/>
      </view>
    </view>

    <view class="menu-group">
      <view class="menu-title">å…¶ä»–</view>
      <view class="menu-item" bindtap="handleAboutUs">
        <view class="menu-left">
          <view class="menu-icon">â„¹ï¸</view>
          <text class="menu-text">å…³äºæˆ‘ä»¬</text>
        </view>
        <text class="arrow">></text>
      </view>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½•æŒ‰é’® -->
  <view class="logout-area" wx:if="{{isLoggedIn}}">
    <button class="logout-btn" bindtap="handleLogout">é€€å‡ºç™»å½•</button>
  </view>
</view> 